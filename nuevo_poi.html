<html>

<head>
    <link rel="stylesheet" href="nuevo_poi.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.js"></script>-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-multiselect/0.9.15/js/bootstrap-multiselect.min.js"></script>

    <script src="https://cdn.rawgit.com/harvesthq/chosen/gh-pages/chosen.jquery.min.js"></script>
    <link href="https://cdn.rawgit.com/harvesthq/chosen/gh-pages/chosen.min.css" rel="stylesheet" />


    <script>
        var nombre = '';
        var distancia = 0;
        var notas = '';

        function salir() {
            window.parent.desbloquea_insertar_registro();
        }

        function add() {
            if (edicion == 'S') {
                window.parent.borra_punto(indice);
            }
            var punto = document.getElementById('nombre').value;
            var distancia = parseFloat(document.getElementById('distancia').value);
            var comentarios = document.getElementById('comentarios').value;
            var lista_atributos = $(".chosen-select").val();

            window.parent.add(punto, distancia, comentarios, lista_atributos);

            if (edicion == 'S') {
                salir();
            }

            document.getElementById('nombre').value = '';
            document.getElementById('distancia').value = '';
            document.getElementById('comentarios').value = '';

            document.getElementById('nombre').focus();

        }
    </script>
</head>

<body onload="document.getElementById('nombre').focus();">
    <table style="width:100%;height:100%;background-color: white;">
        <tr>
            <td class="titulo" style="width:100%;">NUEVO POI</td>
        </tr>
        <tr style="vertical-align: top;">
            <td>
                <table style="width:100%;height:100%;vertical-align: top;">
                    <tr style="vertical-align: top;min-height: 70px;">
                        <td class="etiqueta" style="min-width:80px;">Nombre</td>
                        <td style="width:100%;">
                            <input type="text" id="nombre" style="width:90%;" onfocus="this.style.backgroundColor='palegoldenrod';" onblur="this.style.backgroundColor='white';">
                        </td>
                    </tr>
                    <tr style="min-height:70px;">
                        <td class="etiqueta">Distancia</td>
                        <td>
                            <input type="number" id="distancia" style="width:100px;" onfocus="this.style.backgroundColor='palegoldenrod';" onblur="this.style.backgroundColor='white';">
                        </td>
                    </tr>
                    <tr style="min-height:70px;">
                        <td class="etiqueta">Comentarios</td>
                        <td>
                            <input type="text" id="comentarios" style="width:90%;" onfocus="this.style.backgroundColor='palegoldenrod';" onblur="this.style.backgroundColor='white';">
                        </td>
                    </tr>
                    <tr style="height:100%;vertical-align: top;">
                        <td class="etiqueta">Atributos</td>
                        <td>
                            <select id="atributos" style="width:90%;" data-placeholder="Seleccione uno o varios..." multiple class="chosen-select">
                                <option value="gasolinera">Gasolinera</option>
                                <option value="inicio">Inicio</option>
                                <option value="poblacion">Poblaci√≥n</option>
                                <option value="inicio_subida">Inicio subida</option>
                                <option value="fin_subida">Fin subida</option>
                                <option value="inicio_bajada">Inicio bajada</option>
                                <option value="fin_bajada">Fin bajada</option>
                                <option value="comida">Comida</option>
                                <option value="alojamiento">Alojamiento</option>
                                <option value="taller">Taller</option>
                            </select>

                        </td>
                    </tr>
                    <tr style="min-height:70px;">
                        <td style="padding-top:10px;" colspan="2">
                            <table style="width:100%;">
                                <tr>
                                    <td style="width:50%;text-align: right;padding-right:10px;"><button id="btn_accion" onclick="add();">ADD</button></td>
                                    <td style="width:50%;text-align: left;padding-left:10px;"><button onclick="salir();">EXIT</button></td>
                                </tr>
                            </table>
                        </td>
                    </tr>
                </table>
            </td>
        </tr>
    </table>

    <script>
        $(".chosen-select").chosen({
            no_results_text: ""
        })

        var params = (new URL(document.location)).searchParams;
        edicion = params.get("edicion");
        if (edicion == 'S') {
            var indice = params.get("indice");
            window.parent.get_punto(indice);

            document.getElementById('btn_accion').innerHTML = 'EDIT';
        }

        function set_valores_formulario(nombre, distancia, notas, atributos) {
            document.getElementById('nombre').value = nombre;
            document.getElementById('distancia').value = distancia;
            document.getElementById('comentarios').value = notas;

            $.each(atributos, function (i, e) {
                $('.chosen-select').multiselect('select', e);
            });
            $('.chosen-select').multiselect('refresh');

        }
    </script>
</body>

</html>